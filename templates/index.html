<!DOCTYPE html>
<html>
<head>
    <title>Local Farms</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <style>
        /* Set a more modern font family */
        html * {
            font-family: 'Times New Roman', Times, serif; /* Classic and formal font style */
            font-weight: normal;
        }

        body {
            display: flex;
            flex-direction: column; 
            height: 100vh;
            margin: 0;
            padding: 0;
            background-color: #40E0D0; 
        }
		.dark-mode, .dark-mode div, .dark-mode .banner {
    background-color: #000000;
    color: #FFFFFF;
}
.dark-mode .banner2 {
    background-color: #6A0DAD; /* Light purple instead of turquoise */
}

.dark-mode {
    background-color: #000000; /* Black background for the entire page */
    color: #FFFFFF; /* White text color for better readability */
}

.dark-mode .rightSection, .dark-mode .contactBox {
    background-color: #000000; /* Darker gray to suit dark mode */
	color: #FFFFFF;
}


        .banner {
            width: 100%;
            height: 80px;
            background-color: rgb(230,223, 218); 
            color: #383736;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .banner2 {
            width: 100%;
            height: 20px;
            background-color: #40E0D0;
            color: rgb(230,223, 218);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 20px; 
        }

        #map {
            width: 100%;
            height: 100%;
            position: relative; 
            z-index: 0; 
        }

        .mainSection {
            flex: 1; 
            display: flex;
        }

        .middleSection {
            flex: 2; 
            justify-content: center;
            align-items: center;
        }

        .rightSection {
            flex: 1; 
            padding: 20px;
            background-color: rgb(230,223, 218);
            color: #383736;
        }

        .contactBox {
            border: 3px solid #383736; /* Border for the contact box */
            padding: 10px; /* Padding for the contact box content */
            margin-top: 20px; /* Margin from the farm information */
        }

        .popupForm {
            display: none; /* Initially hidden */
            position: fixed;
            top: 20%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 20px;
            z-index: 10;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 5;
        }
    </style>
</head>
<body>
    <div class="overlay" onclick="closeForm()"></div>
    <div class="banner">
		<div style="display: block;">
        <h1>Welcome to Team 10:s Local Farms!</h1>
		<p style="font-size: smaller">Here, we show you local food sourcing alternatives. Please enjoy and add you own farms to expand the map!</p>
		 </div>
		<button onclick="toggleMode()">Light/Dark Mode</button> <!-- Button to toggle light/dark mode -->
    
	</div>
    <div class="banner2">
    <div class="upperLeftSection">
        <button onclick="showForm()">Add Farm</button> <!-- Ny knapp för att lägga till farm -->
        <select id="farmSelect" onchange="zoomToFarm()">
            <option value="">--Select a Farm--</option>
            {% for farm in farms %}
            <option value="{{ farm['id'] }}" data-lat="{{ farm['latitude'] }}" data-lng="{{ farm['longitude'] }}" data-description="{{ farm['description'] }}" data-rating="{{ farm['rating'] }}" data-address="{{ farm['address'] }}" data-website="{{ farm['website'] }}" data-phonenumber="{{ farm['phonenumber'] }}">
                {{ farm['name'] }}
            </option>
            {% endfor %}
        </select>
    </div>
    <div class="lowerLeftSection">
        <div class="dropdown">
            <button class="dropbtn">Apply Filters</button>
            <div class="dropdown-content" id="tagDropdown">
                
            </div>
        </div>
    </div>        
</div>

    <div class="mainSection">
        <div class="middleSection">
            <div id="map"></div>
        </div>

        <div class="rightSection">
            <h1 id="farmName">Farm Name</h1>
            <div id="farmInfo" class="farmInfo"></div>
            <div class="contactBox">
                <h2>Contact Farm</h2>
                <div id="contactInfo" class="contactInfo"></div>
            </div>
        </div>
    </div>

    <!-- Farm Form Popup -->
    <div class="popupForm" id="addFarmForm">
        <h2>Here you can add a new farm that's not included in our map! </h2>
        <label for="newFarmName">Name:</label>
        <input type="text" id="newFarmName" name="newFarmName">
        <label for="newFarmAddress">Address:</label>
        <input type="text" id="newFarmAddress" name="newFarmAddress">
        <button onclick="submitNewFarm()">Submit</button>
    </div>

    <script>
        var map = L.map('map', {
            minZoom: 3,  // Minimum zoom level
            maxZoom: 18, // Maximum zoom level
            maxBounds: [  // Define the geographical boundaries to restrict the map panning
                [-100, -160],  // SouthWest corner of the boundary
                [150, 180]    // NorthEast corner of the boundary
            ],
            maxBoundsViscosity: 1.0  // Makes the bounds fully rigid
        }).setView([63, 15], 5.4);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: 'Map data © <a href="https://openstreetmap.org">OpenStreetMap</a> contributors',
            noWrap: true
        }).addTo(map);

        function showForm() {
            document.querySelector('.overlay').style.display = 'block';
            document.getElementById('addFarmForm').style.display = 'block';
        }

        function closeForm() {
            document.querySelector('.overlay').style.display = 'none';
            document.getElementById('addFarmForm').style.display = 'none';
        }

        function submitNewFarm() {
            var name = document.getElementById('newFarmName').value;
            var address = document.getElementById('newFarmAddress').value;
            console.log('New Farm Name:', name, 'Address:', address);
            closeForm();
        }
		function toggleMode() {
        document.body.classList.toggle('dark-mode'); 
    }
    </script>
</body>
</html>
